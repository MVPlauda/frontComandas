{% extends "base.html" %}
{% block title %}Funcionário{% endblock %}
{# ajusta a variáveis conforme novo ou edit #}
{% set id = result[0].id if result else '0' %}
{% set nome = result[0].nome if result else '' %}
{% set matricula = result[0].matricula if result else '' %}
{% set cpf = result[0].cpf if result else '' %}
{% set telefone = result[0].telefone if result else '' %}
{% set login = result[0].login if result else '' %}
{% set grupo = result[0].grupo if result else '' %}
{% set senha = result[0].senha if result else '' %}
{% block content %}
<form name="{{ 'formEditar' if result else 'formAdicionar' }}" id="{{ 'formEditar' if result else 'formAdicionar' }}"
 action="{{ url_for('funcionario.edit') if result else url_for('funcionario.insert') }}" method="POST">
    <h1>Funcionário</h1>

    <!-- <div class="mb-3">
        <label for="id" class="form-label">Código</label>
    </div> -->

    <input class="form-control" hidden type="text" name="id" id="id" value="{{ id }}" placeholder="Código" readonly>
    <div class="mb-3">
        <label class="form-label" for="nome">Nome Funcionário</label>
        <input class="form-control" type="text" name="nome" id="nome" value="{{ nome }}" placeholder="Nome Funcionário"
            maxlength="100" autofocus required>
    </div>

    <div class="mb-3">
        <label class="form-label" for="matricula">Matrícula</label>
        <input class="form-control" type="text" name="matricula" id="matricula" value="{{ matricula }}" placeholder="Matrícula"
            maxlength="15" required>
    </div>

    <div class="mb-3">
        <label for="cpf">CPF</label>
        <input class="form-control" type="text" name="cpf" id="cpf" value="{{ cpf }}" placeholder="CPF" maxlength="15" required>
    </div>

    <div class="mb-3">
        <label for="telefone" class="form-label">Telefone</label>
        <input class="form-control" type="tel" name="telefone" id="telefone" value="{{ telefone }}" placeholder="Telefone"
            maxlength="15" required>
    </div>

    <div class="mb-3">
        <label for="grupo">Grupo</label>
        <select class="form-select" name="grupo" id="grupo" aria-label="Grupo">

            <!-- NÃO ENTENDI O QUE ROLOU AQUI -->
            <option value="0" {{ 'selected' if grupo == 0 else '' }}>Atendente</option>
            <option value="1" {{ 'selected' if grupo == 1 else '' }}>Caixa</option>
            <option value="2" {{ 'selected' if grupo == 2 else '' }}>Adm</option>
        </select>
    </div>
    <div class="mb-3">
        <label for="senha">Senha</label>
        <input class="form-control" type="password" name="senha" id="senha" value="{{ senha }}" placeholder="Senha" required>
    </div>

    <div class="mb-3">
        <label for="resenha">Repetir Senha</label>
        <input class="form-control" type="password" name="resenha" id="resenha" value="{{ senha }}" placeholder="Repetir Senha" required>
    </div>

    <button class="btn btn-primary" type='submit' name='salvaUsuarioDB' id='salvaUsuarioDB'><i class='fas fa-save'></i> Salvar</button>
</form>
{% endblock %}
{% block js %}
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js" integrity="sha512-pHVGpX7F/27yZ0ISY+VVjyULApbDlD0/X0rgGbTqCE7WFW5MezNTWG/dnhtbBuICzsd0WQPgpE4REBLv+UqChw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
<script>
    $(function () {
        var cpf = $('#cpf');
        var mask = '000.000.000-00';
        cpf.mask(mask);

        var phone = $('#telefone');
		var mask = '(00) 00000-0000';

		phone.mask(mask);
		phone.on('keyup', function () {

			var number = $(this).val()[5];

			if (number != 9) {
				phone.mask('(00) 0000-0000');
			} else {
				phone.mask(mask);
			}

		});

    })
</script>
{% endblock %}